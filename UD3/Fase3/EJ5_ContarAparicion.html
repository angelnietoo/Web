<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Contador de subcadenas — simple</title>
    <style>
        /* Base */
        body {
            font-family: system-ui, Arial, sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f6f7fb;
        }

        /* Tarjeta con más padding horizontal para evitar labels pegados */
        .card {
            width: min(720px, 96%);
            background: #fff;
            padding: 20px 24px;
            /* aumentado */
            border-radius: 10px;
            box-shadow: 0 8px 24px rgba(15, 23, 42, .06);
            box-sizing: border-box;
        }

        /* Etiquetas claras y separadas */
        label {
            display: block;
            /* fuerza salto de línea y evita alineaciones raras */
            margin: 10px 0 6px;
            /* espacio superior e inferior */
            color: #0f172a;
            font-size: 14px;
        }

        /* Inputs y textarea ocupan todo pero respetan padding interno */
        textarea,
        input {
            width: 100%;
            padding: 10px;
            /* un poco más cómodo */
            border: 1px solid #e6edf3;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box;
            resize: vertical;
            background: #fff;
        }

        .row {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            align-items: center;
        }

        button {
            padding: 8px 10px;
            border: 0;
            border-radius: 6px;
            background: #0ea5a4;
            color: #fff;
            cursor: pointer;
        }

        button.ghost {
            background: #64748b;
        }

        pre {
            background: #fbfdff;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            white-space: pre-wrap;
            box-sizing: border-box;
        }

        /* Ajustes responsivos */
        @media (max-width: 420px) {
            .card {
                padding: 16px;
            }

            label {
                font-size: 13px;
            }
        }
    </style>
</head>

<body>
    <div class="card">
        <h3 style="margin:0 0 8px">Contador de subcadenas (no solapado)</h3>

        <label for="text">Texto</label>
        <textarea id="text" rows="6">claro</textarea>

        <label for="sub" style="margin-top:8px">Subcadena</label>
        <input id="sub" type="text" value="claro" />

        <div class="row">
            <button id="run">Contar</button>
            <button id="copy" class="ghost">Copiar resultado</button>
        </div>

        <pre id="out">Pulsa "Contar" — resultado aquí.</pre>
    </div>

    <script>
        // Función: cuenta apariciones NO solapadas de 'needle' en 'hay' (case-sensitive).
        function countNonOverlapping(hay, needle) {
            // Si la subcadena es vacía o falsy, devolvemos 0 (evita bucle infinito).
            if (!needle) return 0;

            // pos: posición desde la que buscamos; count: contador de coincidencias;
            // step: longitud de la subcadena (se usa para saltar y evitar solapamientos).
            let pos = 0, count = 0, step = needle.length;

            // indexOf busca la siguiente ocurrencia empezando en pos.
            // Cuando no encuentra devuelve -1 y termina el bucle.
            while ((pos = hay.indexOf(needle, pos)) !== -1) {
                count++;         // contabiliza la coincidencia encontrada
                pos += step;     // avanza pos para NO contar coincidencias solapadas
            }

            return count;
        }

        /* Referencias a elementos del DOM (entrada, subcadena y salida) */
        const T = document.getElementById('text'); // textarea con el texto
        const S = document.getElementById('sub');  // input con la subcadena
        const OUT = document.getElementById('out'); // área donde se muestra el resultado

        // Manejador del botón "Contar": obtiene valores, llama a la función y muestra el resultado.
        document.getElementById('run').onclick = () => {
            const n = countNonOverlapping(T.value, S.value);
            OUT.textContent = `Apariciones (no solapado): ${n}`;
        };

        // Manejador del botón "Copiar resultado": usa la API del portapapeles (async).
        document.getElementById('copy').onclick = async () => {
            try {
                // Intento de copiar el texto mostrado. Requiere HTTPS en la mayoría de navegadores.
                await navigator.clipboard.writeText(OUT.textContent);

                // Mensaje temporal de éxito: lo mostramos y lo restauramos tras 900 ms.
                const prev = OUT.textContent;
                OUT.textContent = 'Copiado ✓';
                setTimeout(() => OUT.textContent = prev, 900);
            } catch {
                // Si falla (permiso, no HTTPS, navegador antiguo), mostramos error temporal.
                OUT.textContent = 'No se pudo copiar';
                setTimeout(() => OUT.textContent = 'Pulsa "Contar" — resultado aquí.', 900);
            }
        };

        // Autoejecución: simula un clic en "Contar" al cargar para mostrar resultado inicial.
        document.getElementById('run').click();
    </script>
</body>

</html>