<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <title>Adivina la contraseña — contraseña predefinida</title>
    <style>
        body {
            font-family: Arial;
            margin: 24px;
            background: #f5f8ff
        }

        .box {
            background: #fff;
            padding: 14px;
            border-radius: 8px;
            max-width: 720px;
            margin: 0 auto;
            box-shadow: 0 6px 18px rgba(10, 20, 50, 0.06)
        }

        input,
        button {
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #d7e6ff
        }

        .row {
            display: flex;
            gap: 8px;
            margin: 8px 0;
            align-items: center
        }

        .small {
            font-size: 13px;
            color: #556
        }

        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            margin: 4px
        }

        .player-list {
            display: flex;
            gap: 8px
        }

        .played {
            opacity: 0.55;
            text-decoration: line-through
        }

        .info {
            font-size: 13px;
            color: #334;
            margin-top: 6px
        }
    </style>
</head>

<body>
    <main class="box">
        <h2>Adivina la contraseña — contraseña predefinida</h2>
        <div class="small">Reglas: vocal=1, consonante=2, número=3. Comparación <strong>case-sensitive</strong>.<br>Los
            intentos no pueden exceder la longitud de la contraseña, pero se pueden enviar con menos caracteres (>=1).
        </div>

        <!-- Mostramos la contraseña de forma enmascarada; el valor real está definido en el código y no es editable por el usuario -->
        <div class="row">
            <div style="min-width:160px"><strong>Contraseña (oculta):</strong></div>
            <div id="pw-mask" style="font-weight:700;letter-spacing:1px">••••••••••</div>
            <div id="length-info" class="info"></div>
        </div>

        <!-- Nombres editable de los 3 jugadores -->
        <div class="row player-list">
            <input id="name1" value="Jugador 1">
            <input id="name2" value="Jugador 2">
            <input id="name3" value="Jugador 3">
        </div>

        <div class="row">
            <div style="min-width:160px"><strong>Turno:</strong> <span id="current-player">Jugador 1</span></div>
            <input id="guess" placeholder="Tu intento" style="flex:1">
            <button id="go">Enviar</button>
        </div>

        <div id="out" style="margin-top:10px"></div>
        <hr />
        <div>
            <strong>Marcador:</strong>
            <div id="scores" class="small">Jugador 1: 0 — Jugador 2: 0 — Jugador 3: 0</div>
            <div id="status" class="small" style="margin-top:6px">Quedan 3 jugadores por jugar.</div>
        </div>
    </main>

    <script>
        /*
          Versión final: la contraseña está predefinida por el programa y no es editable por el usuario.
          - Contraseña: "Vhiwklñs18"
          - El campo visible muestra la contraseña enmascarada.
          - El juego funciona igual: 1 intento por jugador, avance automático, intentos <= longitud de la contraseña, se puede enviar con menos caracteres (>=1).
        */
        (() => {
            // shortcut DOM
            const $ = id => document.getElementById(id);
            const elems = {
                pwMask: $('pw-mask'), lengthInfo: $('length-info'), guess: $('guess'), go: $('go'), out: $('out'),
                currentPlayer: $('current-player'), scores: $('scores'), status: $('status'), names: [$('name1'), $('name2'), $('name3')]
            };

            // ====== CONTRASEÑA PREDEFINIDA (no editable por el usuario) ======
            const PREDEFINED_PW = 'Vhiwklñs18'; // <--- contraseña fijada por el programa
            const PW_LEN = PREDEFINED_PW.length;

            // estado
            const scores = [0, 0, 0];
            const played = [false, false, false];
            let current = 0;

            // util: puntos por caracter
            const charPoints = ch => /[0-9]/.test(ch) ? 3 : /[A-Za-z]/.test(ch) ? ('aeiouAEIOU'.includes(ch) ? 1 : 2) : 0;

            // helper: escape HTML
            const escapeHtml = s => String(s).replace(/[&<>\\"']/g, ch => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": "&#39;" })[ch]);

            // mostrar máscara y longitud (solo lectura)
            elems.pwMask.textContent = '•'.repeat(PW_LEN);
            elems.lengthInfo.textContent = `Longitud requerida: ${PW_LEN} caracteres.`;

            // render marcador y estado
            const renderScores = () => elems.scores.textContent = `Jugador 1: ${scores[0]} — Jugador 2: ${scores[1]} — Jugador 3: ${scores[2]}`;

            function renderState() {
                const remaining = played.filter(x => !x).length;
                if (remaining === 0) {
                    elems.currentPlayer.textContent = '— todos han jugado —'; elems.go.disabled = true; elems.guess.disabled = true; elems.status.textContent = 'Partida finalizada.';
                    const max = Math.max(...scores);
                    const winners = elems.names.filter((n, i) => scores[i] === max).map(n => n.value || `Jugador`);
                    elems.out.innerHTML = `<div><strong>Ganador(es):</strong> ${winners.join(', ')} — ${max} puntos</div>` + (elems.out.innerHTML || '');
                    return;
                }
                if (played[current]) for (let i = 1; i <= 3; i++) { const idx = (current + i) % 3; if (!played[idx]) { current = idx; break; } }
                elems.currentPlayer.textContent = elems.names[current].value || `Jugador ${current + 1}`;
                elems.status.textContent = `Quedan ${remaining} jugador(es) por jugar.`;
                elems.names.forEach((n, i) => n.className = played[i] ? 'played' : '');

                // asegurar maxlength al tamaño de la contraseña y habilitar botón si hay >=1 caracter
                elems.guess.maxLength = PW_LEN;
                elems.go.disabled = !(elems.guess.value.length > 0 && !played[current]);
            }

            // calcular puntuación: coincide si el caracter aparece en la contraseña (case-sensitive)
            const scoreGuess = (guess) => {
                let total = 0; const parts = [];
                for (const ch of guess) { const p = (PREDEFINED_PW.indexOf(ch) !== -1) ? charPoints(ch) : 0; total += p; parts.push({ ch, p, matched: p > 0 }); }
                return { parts, total };
            };

            // evento enviar
            elems.go.addEventListener('click', () => {
                const guess = elems.guess.value || '';
                if (guess.length === 0) { alert('Escribe al menos un caracter antes de enviar.'); return; }
                if (played[current]) { alert('Este jugador ya ha jugado.'); renderState(); return; }

                const res = scoreGuess(guess);
                scores[current] += res.total; played[current] = true;

                elems.out.innerHTML = `<div><strong>${escapeHtml(elems.names[current].value || `Jugador ${current + 1}`)}</strong> intentó "${escapeHtml(guess)}" — puntos: ${res.total}</div>` +
                    `<div style="margin-top:6px">` + res.parts.map(p => `<span class="tag" style="background:${p.matched ? '#e6f7e6' : '#fff2f2'}">${escapeHtml(p.ch)}${p.matched ? (' +' + p.p) : ''}</span>`).join('') + `</div>` + (elems.out.innerHTML || '');

                elems.guess.value = '';
                for (let i = 1; i <= 3; i++) { const idx = (current + i) % 3; if (!played[idx]) { current = idx; break; } }
                renderScores(); renderState();
            });

            // habilitar envío con Enter y control de estado al escribir
            elems.guess.addEventListener('keydown', e => { if (e.key === 'Enter' && !elems.go.disabled) elems.go.click(); });
            elems.guess.addEventListener('input', () => { elems.go.disabled = !(elems.guess.value.length > 0 && !played[current]); });

            // inicializar
            renderScores(); renderState();
        })();
    </script>
</body>

</html>