<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <title>Adivina la contraseña - versión simple (comentada)</title>
    <style>
        /* Estilos mínimos para mantener la versión reducida legible */
        body {
            font-family: Arial;
            margin: 24px;
            background: #f5f8ff
        }

        .box {
            background: #fff;
            padding: 14px;
            border-radius: 8px;
            max-width: 650px;
            margin: 0 auto;
            box-shadow: 0 6px 18px rgba(10, 20, 50, 0.06)
        }

        input,
        button,
        select {
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #d7e6ff
        }

        .row {
            display: flex;
            gap: 8px;
            margin: 8px 0
        }

        .small {
            font-size: 13px;
            color: #556
        }

        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            margin: 4px
        }
    </style>
</head>

<body>
    <main class="box">
        <h2>Adivina la contraseña (3 jugadores) — versión reducida</h2>
        <div class="small">Reglas: vocal=1, consonante=2, número=3. Comparación <strong>case-sensitive</strong>.</div>

        <!-- Campo para establecer la contraseña que estará guardada 'en el sistema' (en este archivo) -->
        <div class="row">
            <label>Contraseña: <input id="pw" type="password" value="L4ultimavezKtelod1go"></label>
        </div>

        <!-- Selector de jugador + campo de intento + botón enviar -->
        <div class="row">
            <select id="player">
                <option>Jugador 1</option>
                <option>Jugador 2</option>
                <option>Jugador 3</option>
            </select>
            <input id="guess" placeholder="Tu intento">
            <button id="go">Enviar</button>
        </div>

        <!-- Área de salida para mostrar resultado del intento -->
        <div id="out" style="margin-top:10px"></div>
        <hr />
        <div>
            <strong>Marcador:</strong>
            <div id="scores" class="small">Jugador 1: 0 — Jugador 2: 0 — Jugador 3: 0</div>
        </div>
    </main>

    <script>
        /*
          Versión reducida con comentarios explicativos.
          Comentarios en español que describen qué hace cada bloque:
          - utilidades de detección de caracteres
          - referencias al DOM
          - lógica de puntuación
          - renderizado de marcador
          - manejador del botón Enviar
        */
        (() => {
            // ---------- Utilidades de detección y puntuación ----------
            // Devuelve true si el caracter es un dígito 0-9
            const isDigit = c => /[0-9]/.test(c);
            // Devuelve true si el caracter es una letra A-Z o a-z
            const isLetter = c => /[A-Za-z]/.test(c);
            // Devuelve true si es vocal (incluye mayúsculas y minúsculas)
            const isVowel = c => 'aeiouAEIOU'.includes(c);
            // Calcula puntos según la regla: dígito=3, vocal=1, consonante=2, otro=0
            const pts = c => isDigit(c) ? 3 : isLetter(c) ? (isVowel(c) ? 1 : 2) : 0;

            // ---------- Referencias DOM (elementos HTML que usaremos) ----------
            const pwEl = document.getElementById('pw');         // input donde se escribe la contraseña "guardada"
            const playerEl = document.getElementById('player'); // select para elegir jugador activo
            const guessEl = document.getElementById('guess');   // input para poner el intento
            const out = document.getElementById('out');         // div donde imprimimos detalle del intento
            const scoresEl = document.getElementById('scores'); // div con marcador acumulado
            const go = document.getElementById('go');           // botón Enviar

            // ---------- Estado del juego ----------
            // Array con 3 posiciones: índices 0..2 para Jugador 1..3
            const scores = [0, 0, 0];

            // ---------- Función para actualizar la vista del marcador ----------
            // Es simple: actualiza el texto con los puntos acumulados de los 3 jugadores
            function renderScores() {
                scoresEl.textContent = `Jugador 1: ${scores[0]} — Jugador 2: ${scores[1]} — Jugador 3: ${scores[2]}`;
            }

            // ---------- Lógica que compara el intento con la contraseña ----------
            // scoreGuess recibe el intento (guess) y la contraseña (pw)
            // Recorre cada caracter del intento y determina:
            //  - si existe en la contraseña (búsqueda case-sensitive con indexOf)
            //  - cuántos puntos aporta ese caracter según pts()
            // Devuelve un objeto con partes (detalle por caracter) y el total
            function scoreGuess(guess, pw) {
                let total = 0;
                const parts = []; // array de {ch, matched: boolean, p: puntos}
                for (let ch of guess) {
                    const matched = pw.indexOf(ch) !== -1; // true si ese caracter aparece en la contraseña
                    const p = matched ? pts(ch) : 0;       // puntos solo si hay match
                    total += p;
                    parts.push({ ch, matched, p });
                }
                return { parts, total };
            }

            // ---------- Evento: al pulsar Enviar ----------
            go.addEventListener('click', () => {
                const pw = pwEl.value || '';      // contraseña actual
                const guess = guessEl.value || ''; // intento del jugador

                // Validación mínima: debe escribir algo
                if (!guess) {
                    alert('Escribe un intento.');
                    return;
                }

                // Calculamos puntuación y detalle
                const res = scoreGuess(guess, pw);

                // Determinamos qué jugador está jugando (selectedIndex: 0..2)
                const idx = playerEl.selectedIndex;

                // Sumamos puntos al marcador acumulado del jugador
                scores[idx] += res.total;

                // Mostramos resultado resumido y etiquetas por carácter
                // - usamos una etiqueta visual simple para cada caracter
                // - color de fondo indica si acertó o no
                out.innerHTML = `<div><strong>${playerEl.value}</strong> intentó "${escapeHtml(guess)}" — puntos: ${res.total}</div>` +
                    `<div style="margin-top:6px">` +
                    res.parts.map(p => `
        <span class="tag" style="background:${p.matched ? '#e6f7e6' : '#fff2f2'}">${escapeHtml(p.ch)}${p.matched ? (' +' + p.p) : ''}</span>
      `).join('') + `</div>`;

                // Actualizamos marcador y limpiamos el campo de intento
                renderScores();
                guessEl.value = '';
                guessEl.focus();
            });

            // ---------- Inicialización ----------
            renderScores();

            // ---------- Utilidad: escape simple para evitar inyección HTML en la salida ----------
            function escapeHtml(str) {
                return String(str).replace(/[&<>\"']/g, s => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": "&#39;" })[s]);
            }

        })();
    </script>
</body>

</html>