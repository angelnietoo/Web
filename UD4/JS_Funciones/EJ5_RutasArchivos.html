<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Ejercicio 5 - Listar Archivos con rutas</title>
    <link rel="stylesheet" href="CSS/styles.css">
</head>

<body>
    <main class="exercise">
        <h1>Ejercicio 5 — Listar Archivos con rutas</h1>

        <div class="content">
            <p>Este ejemplo devuelve la lista de archivos incluyendo la ruta completa dentro del objeto.</p>

            <label for="fs2_input">Estructura (JSON):
                <textarea id="fs2_input" name="fs2_input" rows="8">{
  "carpeta1": {
    "archivo1": "contenido1",
    "archivo2": "contenido2",
    "subcarpeta": { "archivo3": "contenido3" }
  },
  "carpeta2": { "archivo4": "contenido4" }
}</textarea>
            </label>

            <pre id="out5" aria-live="polite">Salida...</pre>
        </div>

        <div class="actions">
            <button id="btn5" type="button">Listar archivos con rutas</button>
        </div>
    </main>

    <script>
        function listarArchivosConRuta(obj, base = '') {
             // Array donde se acumulan las rutas
            const archivos = [];
            for (const [clave, valor] of Object.entries(obj)) {
                 // Ruta completa del archivo o subcarpeta
                const ruta = base ? `${base}/${clave}` : clave;
                if (valor && typeof valor === 'object' && !Array.isArray(valor)) {
                    archivos.push(...listarArchivosConRuta(valor, ruta));
                } else {
                    archivos.push(ruta);
                }
            }
            return archivos;
        }

        // Evento del botón y obtenemos el valor JSON ingresado del usuario y la salida
        document.getElementById('btn5').addEventListener('click', () => {
            const txt = document.getElementById('fs2_input').value.trim();
            const out = document.getElementById('out5');

            try {
                 // Parse del JSON
                const obj = JSON.parse(txt);
                if (typeof obj !== 'object' || Array.isArray(obj) || obj === null) {
                    throw new Error('Se esperaba un objeto válido');
                }
                // Resultado final: rutas completas
                const res = listarArchivosConRuta(obj);
                out.textContent = JSON.stringify(res, null, 2);
            } catch (e) {
                out.textContent = 'Error: ' + e.message;
            }
        });
    </script>
</body>
</html>